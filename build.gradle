plugins {
    id 'java'
    id "com.github.spacialcircumstances.gradle-cucumber-reporting" version "0.1.24"
}

repositories {
    mavenCentral()
}

java {
    toolchain {
        languageVersion = JavaLanguageVersion.of("${java_version}")
    }
}

ext['log4j2.version'] = "${log4j2_version}"
ext['tomcat.version'] = "${tomcat_version}"

dependencies {
    implementation 'org.seleniumhq.selenium:selenium-java:4.1.3'
    implementation 'io.github.bonigarcia:webdrivermanager:5.1.0'
    implementation 'org.testng:testng:7.5'
    implementation 'io.cucumber:cucumber-java:7.2.3'
    implementation 'io.cucumber:cucumber-testng:7.2.3'
    implementation 'org.slf4j:slf4j-simple:1.7.35'

    implementation "org.projectlombok:lombok:${org_projectlombok_lombok_version}"
    testImplementation "org.projectlombok:lombok:${org_projectlombok_lombok_version}"
    annotationProcessor "org.projectlombok:lombok:${org_projectlombok_lombok_version}"
    testAnnotationProcessor "org.projectlombok:lombok:${org_projectlombok_lombok_version}"
}

test {
    useTestNG() {
        suites "testng.xml"
        testLogging.showStandardStreams = true
        //report generation delegated to TestNG library:
        useDefaultListeners = true
        outputDirectory = file("$project.buildDir//testngOutput")
    }
    //turn off Gradle's HTML report to avoid replacing the reports generated by TestNG library:
    reports.html.enabled(false)

    systemProperty 'platform', System.getProperty('platform')
}

cucumberReports {
    outputDir = file('build/reports/')
    buildId = '0'
    reports = files('build/cucumber-reports/cucumber.json')
}